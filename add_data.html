<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>إدارة الأصناف</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background: #f9f9f9; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: right; }
    th { background-color: #f44336; color: white; }
    input[type="text"], input[type="number"] { width: 100%; padding: 6px; box-sizing: border-box; }
    button { padding: 6px 12px; margin: 4px; cursor: pointer; border: none; background-color: #4CAF50; color: white; border-radius: 4px; }
    .delete-btn { background-color: #f44336; }
    .action-bar { margin-top: 20px; }
  </style>
</head>
<body>

  <h2>إدارة الأصناف</h2>

  <div class="action-bar">
    <button onclick="addRow()">➕ إضافة صنف</button>
    <button onclick="saveData()">💾 حفظ البيانات</button>
  </div>

  <table id="itemsTable">
    <thead>
      <tr>
        <th>اسم الصنف</th>
        <th>صورة</th>
        <th>السعر</th>
        <th>إجراء</th>
      </tr>
    </thead>
    <tbody id="tableBody">
      <!-- صفوف البيانات ستُضاف هنا -->
    </tbody>
  </table>

  <script>
    const csvUrl = 'https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Data.csv';

    // تحميل البيانات من CSV
    async function loadData() {
      const response = await fetch(csvUrl);
      const text = await response.text();
      const rows = text.trim().split('\n').slice(1); // تخطي العنوان
      rows.forEach(row => {
        const [name, image, price] = row.split(',');
        addRowToTable(name.trim(), image.trim(), price.trim());
      });
    }

    // إضافة صف للجدول
    function addRowToTable(name = '', image = '', price = '') {
      const tbody = document.getElementById('tableBody');
      const row = document.createElement('tr');

      row.innerHTML = `
        <td><input type="text" value="${name}"></td>
        <td><input type="text" value="${image}"></td>
        <td><input type="number" value="${price}"></td>
        <td><button class="delete-btn" onclick="this.closest('tr').remove()">🗑 حذف</button></td>
      `;
      tbody.appendChild(row);
    }

    function addRow() {
      addRowToTable();
    }

    // حفظ البيانات كملف CSV
    function saveData() {
      const rows = [['name', 'image', 'price']];
      const tbody = document.querySelectorAll('#tableBody tr');

      tbody.forEach(tr => {
        const inputs = tr.querySelectorAll('input');
        const row = Array.from(inputs).map(input => input.value.trim());
        rows.push(row);
      });

      const csvContent = rows.map(e => e.join(',')).join('\n');
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'data.csv';
      link.click();
    }

    loadData();
  </script>
</body>
</html>
