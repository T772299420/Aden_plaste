<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>شركة عدن الوطنية للصناعات المنزلية</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Times New Roman', Times, serif;
      background: #FFFFF0;
      margin: 0;
      color: #000;
      padding-top: 100px; /* مكان لشريط التبويبات */
    }
    /* شريط التبويبات */
    #tabBar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: #E41B17;
      display: flex;
      justify-content: space-around;
      align-items: center;
      z-index: 10000;
    }
    #tabBar button {
      background: none;
      border: none;
      color: #FFFFF0;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
      padding: 10px 15px;
      border-bottom: 3px solid transparent;
      transition: border-bottom-color 0.3s ease;
    }
    #tabBar button.active {
      border-bottom-color: #8B0000;
    }
    /* محتوى التبويبات */
    .tabContent {
      display: none;
      max-width: 1000px;
      margin: auto;
      padding: 20px;
      color: #000;
    }
    .tabContent.active {
      display: block;
    }
    /* النص التعريفي في الرئيسية */
    #home p {
      font-family: 'Times New Roman', Times, serif;
      color: black;
      text-align: justify;
      line-height: 1.6;
      margin-top: 20px;
    }
    /* مبيعات */
    #toolbar {
      position: sticky;
      top: 60px;
      left: 0;
      right: 0;
      height: 60px;
      background: #E41B17;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 15px;
      padding: 0 20px;
      z-index: 9999;
      transition: top 0.4s ease-in-out;
      color: #FFFFF0;
    }
    #toolbar label {
      color: #FFFFF0;
      font-weight: bold;
    }
    #toolbar button {
      height: 40px;
      width: 40px;
      background-color: #E41B17;
      border: none;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    #toolbar button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #toolbar img {
      width: 24px;
      height: 24px;
      filter: brightness(100%) invert(100%);
    }
    #imageSizeRange {
      width: 150px;
    }
    img.logo {
      width: 100px;
      margin: 20px auto;
      display: block;
      animation: move-logo 5s alternate infinite;
    }
    @keyframes move-logo {
      0% { transform: translateX(100px); }
      100% { transform: translateX(-100px); }
    }
    .item {
      background: #fff;
      margin: 10px auto;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 5px #ccc;
      display: flex;
      border: 2px solid #E41B17;
      align-items: center;
      gap: 15px;
      max-width: 900px;
      color: #8B0000;
    }
    .item img {
      width: 120px;
      height: 120px;
      object-fit: contain;
      border-radius: 6px;
      border: 3px solid #E41B17;
      cursor: pointer;
      transition: border-color 0.3s ease;
    }
    .item-details {
      flex-grow: 1;
      text-align: right;
    }
    .item-qty input {
      width: 70px;
    }
    #overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
    }
    #formModal {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      text-align: center;
      color: #000;
    }
    #formModal input {
      width: 90%;
      margin: 5px 0;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      color: #000;
    }
    #formModal button {
      margin-top: 10px;
      padding: 10px 20px;
      background: #E41B17;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    footer {
      text-align: center;
      margin-top: 40px;
      padding: 20px;
      font-size: 14px;
      color: #8B0000;
      border-top: 2px solid #E41B17;
    }

    /* نافذة تكبير الصورة */
    #imgOverlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.8);
      justify-content: center;
      align-items: center;
      z-index: 20000;
      cursor: pointer;
      display: flex;
    }
    #imgOverlay img {
      max-width: 90vw;
      max-height: 90vh;
      border-radius: 10px;
      box-shadow: 0 0 20px #fff;
    }
  </style>
</head>
<body>
  <!-- شريط التبويبات -->
  <div id="tabBar">
    <button class="tabBtn active" data-tab="home">الرئيسية</button>
    <button class="tabBtn" data-tab="sales">مبيعات</button>
    <button class="tabBtn" data-tab="returns">مرتجعات</button>
    <button class="tabBtn" data-tab="contact">راسلنا</button>
  </div>

  <!-- المحتوى -->
  <div id="home" class="tabContent active">
    <img src="001.jpg" class="logo" alt="Aden Plastic logo" />
    <h2 style="text-align:center; font-weight:bold; color:#8B0000;">شركة عدن الوطنية للصناعات المنزلية</h2>
    <p>
      الشركة الوطنية الرائدة في تصنيع منتجات البلاستيك المنزلية والمكتبية عالية الجودة.
      تعد شركة عدن الوطنية للصناعات المنزلية المحدودة - المعروفة اختصاراً بـ " عدن بلاستيك" - واحدة من الشركات الصناعية الرائدة في مجال إنتاج الأدوات المنزلية وأدوات التعبئة والتغليف بالإضافة لمستلزمات الأثاث المنزلي. منذ بدايتها الأولى عمدت شركة عدن إلى التميز من خلال التركيز على جودة منتجاتها وإرضاء عملائها، ولتحقيق ذلك عملت الشركة على تشجيع التجديد والابتكار في المنتجات وترسيخ ثقافة الاهتمام بالعميل، وبذلك وضعت شركة عدن نفسها كواحدة من الشركات الرائدة في هذا المجال بفضل اتباع سياستي الاهتمام بالمنتج والعميل. تعتز شركة عدن أن منتجاتها تصنع من مواد خام أولية عالية الجودة تجلب من كبريات الشركات في هذا المجال، وتسويق منتجاتها في كل أرجاء اليمن من خلال شبكة واسعة من الموزعين ونقاط البيع، كما تستهدف الشركة الأسواق المجاورة في منطقة الخليج والقرن الأفريقي، وتشمل منتجاتها على سبيل المثال لا الحصر البراميل، البوالد، السلات، حافظات الأطعمة، الصناديق، رفوف المطبخ، الكراسي والطاولات وغيرها. تضع شركة عدن الوطنية موضوع الاستدامة في مقدمة أولوياتها، حيث تعمل جاهدة للحفاظ على البيئة والارتقاء بالجانب التصنيعي من خلال تقليل استنزاف الموارد واستخدام التكنولوجيا الحديثة بالإضافة إلى التحول إلى خيارات الطاقة البديلة.
    </p>
  </div>

  <div id="sales" class="tabContent">
    <div id="toolbar">
      <label for="imageSizeRange">حجم الصورة:</label>
      <input type="range" id="imageSizeRange" min="60" max="300" value="120" />
      <button id="editInfoBtn" onclick="showForm()">
        <img src="https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Up.png" alt="تعديل" />
      </button>
      <button id="sendWhatsappBtn" onclick="sendToWhatsApp()" disabled>
        <img src="https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Wt.png" alt="واتساب" />
      </button>
      <button id="printPdfBtn" onclick="printPDF()" disabled>
        <img src="https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Pd.png" alt="PDF" />
      </button>
    </div>
    <div id="items"></div>
  </div>

  <div id="returns" class="tabContent">
    <h3 style="text-align:center;">قسم المرتجعات</h3>
    <p style="max-width:800px; margin:auto; text-align:right;">
      هنا يمكنك إدارة المرتجعات الخاصة بالأصناف. هذه الخاصية تحت التطوير حالياً.
    </p>
  </div>

  <div id="contact" class="tabContent">
    <h3 style="text-align:center;">تواصل معنا</h3>
    <p style="max-width:800px; margin:auto; text-align:center;">
      لأي استفسار أو دعم، تواصل معنا عبر:<br />
      الهاتف: 00967772299420<br />
      البريد الإلكتروني: t772299420@gmail.com<br />
      العنوان: الجمهورية اليمنية - إب - القاعدة
    </p>
  </div>

  <!-- نافذة تكبير الصورة -->
  <div id="imgOverlay" style="display:none;">
    <img id="overlayImg" src="" alt="مكبر الصورة" />
  </div>

  <!-- نموذج بيانات العميل -->
  <div id="overlay" style="display:none">
    <div id="formModal">
      <h3>تسجيل معلومات العميل</h3>
      <input type="text" id="fullName" placeholder="الاسم الرباعي" required />
      <input type="text" id="businessName" placeholder="الاسم التجاري" required />
      <input type="text" id="address" placeholder="عنوان المحل" required />
      <input type="tel" id="phone" placeholder="رقم الهاتف" required />
      <button onclick="saveCustomerInfo()">حفظ</button>
    </div>
  </div>

  <footer>
    إعداد وبرمجة<br />
    المميز سوفت للأنظمة المحاسبية المتكاملة<br />
    م / مروان محمد عبد الله الذماري<br />
    00967772299420<br />
    t772299420@gmail.com<br />
  </footer>

  <script>
    // تبويبات الصفحة
    const tabs = document.querySelectorAll('.tabBtn');
    const contents = document.querySelectorAll('.tabContent');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');

        const target = tab.dataset.tab;
        contents.forEach(c => {
          c.classList.toggle('active', c.id === target);
        });
      });
    });

    let customer = null;
    let itemsData = [];

    document.addEventListener('DOMContentLoaded', () => {
      loadCustomerInfo();
      fetchCSV();
      setupImageSizeControl();
    });

    function fetchCSV() {
      fetch('https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Data.csv')
        .then(res => res.text())
        .then(csvText => {
          const wb = XLSX.read(csvText, { type: 'string' });
          const sheet = wb.Sheets[wb.SheetNames[0]];
          itemsData = XLSX.utils.sheet_to_json(sheet);
          displayItems(itemsData);
        })
        .catch(err => {
          console.error('خطأ تحميل CSV:', err);
          alert('تعذر تحميل بيانات الأصناف من GitHub.');
        });
    }

    function displayItems(items) {
      const container = document.getElementById('items');
      container.innerHTML = '';
      items.forEach(item => {
        const image = item.image?.trim();
        const name = item.name?.trim();

        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `
          <img src="https://raw.githubusercontent.com/T772299420/Aden_plaste/main/${image}" alt="${name}" />
          <div class="item-details">
            <p>${name}</p>
            <label>الكمية: <input type="number" min="0" value="0" data-name="${name}" /></label>
          </div>
        `;
        container.appendChild(div);
      });

      attachQtyListeners();
      updateButtonsState();
      attachImageClick();
    }

    function attachQtyListeners() {
      document.querySelectorAll('#items input[type=number]').forEach(input => {
        input.addEventListener('input', () => {
          updateButtonsState();
          highlightSelected(input);
        });
      });
    }

    function highlightSelected(input) {
      const val = parseInt(input.value);
      if (val > 0) {
        input.parentElement.parentElement.querySelector('img').style.borderColor = '#8B0000';
      } else {
        input.parentElement.parentElement.querySelector('img').style.borderColor = '#E41B17';
      }
    }

    function updateButtonsState() {
      const hasQty = Array.from(document.querySelectorAll('#items input[type=number]'))
        .some(input => parseInt(input.value) > 0);

      document.getElementById('sendWhatsappBtn').disabled = !hasQty;
      document.getElementById('printPdfBtn').disabled = !hasQty;
    }

    function setupImageSizeControl() {
      const range = document.getElementById('imageSizeRange');
      range.addEventListener('input', () => {
        const size = range.value;
        document.querySelectorAll('.item img').forEach(img => {
          img.style.width = size + 'px';
          img.style.height = size + 'px';
        });
      });
    }

    // تكبير الصورة عند النقر
    function attachImageClick() {
      document.querySelectorAll('.item img').forEach(img => {
        img.style.cursor = 'pointer';
        img.addEventListener('click', () => {
          const overlay = document.getElementById('imgOverlay');
          const overlayImg = document.getElementById('overlayImg');
          overlayImg.src = img.src;
          overlay.style.display = 'flex';
        });
      });

      document.getElementById('imgOverlay').addEventListener('click', () => {
        document.getElementById('imgOverlay').style.display = 'none';
      });
    }

    function loadCustomerInfo() {
      const saved = localStorage.getItem('customerInfo');
      if (saved) {
        customer = JSON.parse(saved);
      } else {
        showForm();
      }
    }

    function showForm() {
      document.getElementById('overlay').style.display = 'flex';
      if (customer) {
        document.getElementById('fullName').value = customer.fullName;
        document.getElementById('businessName').value = customer.businessName;
        document.getElementById('address').value = customer.address;
        document.getElementById('phone').value = customer.phone;
      }
    }

    function saveCustomerInfo() {
      const fullName = document.getElementById('fullName').value.trim();
      const businessName = document.getElementById('businessName').value.trim();
      const address = document.getElementById('address').value.trim();
      const phone = document.getElementById('phone').value.trim();

      if (!fullName || !businessName || !address || !phone) {
        alert('يرجى تعبئة جميع الحقول.');
        return;
      }

      customer = { fullName, businessName, address, phone };
      localStorage.setItem('customerInfo', JSON.stringify(customer));
      document.getElementById('overlay').style.display = 'none';
    }

    function sendToWhatsApp() {
      if (!customer) {
        alert('يرجى تعبئة بيانات العميل أولاً.');
        showForm();
        return;
      }
      // جمع الأصناف والكمية التي > 0
      let message = `طلب من: ${customer.fullName}\n`;
      message += `الاسم التجاري: ${customer.businessName}\n`;
      message += `العنوان: ${customer.address}\n`;
      message += `رقم الهاتف: ${customer.phone}\n\n`;
      message += `تفاصيل الطلب:\n`;

      const items = document.querySelectorAll('#items .item');
      items.forEach(item => {
        const name = item.querySelector('.item-details p').textContent.trim();
        const qtyInput = item.querySelector('input[type=number]');
        const qty = parseInt(qtyInput.value);
        if (qty > 0) {
          message += `${name}: ${qty}\n`;
        }
      });

        const encodedMessage = encodeURIComponent(message);
      const phone = "967772299420"; // رقم الهاتف مع رمز الدولة بدون +
      const url = `https://wa.me/${phone}?text=${encodedMessage}`;
      window.open(url, '_blank');
    }

    async function printPDF() {
      if (!customer) {
        alert('يرجى تعبئة بيانات العميل أولاً.');
        showForm();
        return;
      }
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({
        unit: "pt",
        format: "a4"
      });

      let y = 40;
      doc.setFontSize(16);
      doc.text("طلب مبيعات - شركة عدن الوطنية للصناعات المنزلية", 40, y);
      y += 30;

      doc.setFontSize(12);
      doc.text(`الاسم الرباعي: ${customer.fullName}`, 40, y);
      y += 20;
      doc.text(`الاسم التجاري: ${customer.businessName}`, 40, y);
      y += 20;
      doc.text(`العنوان: ${customer.address}`, 40, y);
      y += 20;
      doc.text(`رقم الهاتف: ${customer.phone}`, 40, y);
      y += 30;

      doc.text("تفاصيل الطلب:", 40, y);
      y += 20;

      const items = document.querySelectorAll('#items .item');
      items.forEach(item => {
        const name = item.querySelector('.item-details p').textContent.trim();
        const qtyInput = item.querySelector('input[type=number]');
        const qty = parseInt(qtyInput.value);
        if (qty > 0) {
          doc.text(`${name}: ${qty}`, 40, y);
          y += 20;
        }
      });

      doc.save('طلب_مبيعات.pdf');
    }
  </script>
</body>
</html>
