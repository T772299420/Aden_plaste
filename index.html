<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>شركة عدن الوطنية للصناعات المنزلية</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #FFFFF0;
      margin: 0;
      color: #8B0000;
      padding-top: 110px; /* مساحة لشريط التبويبات وشريط الأدوات */
    }
    /* شريط التبويبات */
    #tabBar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: #E41B17;
      display: flex;
      justify-content: space-around;
      align-items: center;
      z-index: 10000;
    }
    #tabBar button {
      background: none;
      border: none;
      color: #FFFFF0;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
      padding: 10px 15px;
      border-bottom: 3px solid transparent;
      transition: border-bottom-color 0.3s ease;
    }
    #tabBar button.active {
      border-bottom-color: #8B0000;
    }
    /* شريط الأدوات تحت التبويبات */
    #toolbar {
      position: fixed;
      top: 60px;
      left: 0;
      right: 0;
      height: 50px;
      background: #E41B17;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 12px;
      padding: 0 15px;
      z-index: 9999;
      color: #FFFFF0;
    }
    #toolbar label {
      color: #FFFFF0;
      font-weight: bold;
      user-select: none;
    }
    #toolbar input[type=range] {
      width: 140px;
      cursor: pointer;
    }
    #toolbar button {
      height: 40px;
      width: 40px;
      background-color: #E41B17;
      border: none;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      padding: 0;
    }
    #toolbar button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #toolbar img {
      width: 24px;
      height: 24px;
      filter: brightness(100%) invert(100%);
      pointer-events: none;
      user-select: none;
    }
    /* محتوى التبويبات */
    .tabContent {
      display: none;
      max-width: 1000px;
      margin: auto;
      padding: 20px;
      text-align: right;
    }
    .tabContent.active {
      display: block;
    }
    /* شعار متحرك */
    img.logo {
      width: 100px;
      margin: 20px auto;
      display: block;
      animation: move-logo 5s alternate infinite;
    }
    @keyframes move-logo {
      0% { transform: translateX(100px); }
      100% { transform: translateX(-100px); }
    }
    /* الأصناف */
    .item {
      background: #fff;
      margin: 10px auto;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 5px #ccc;
      display: flex;
      border: 2px solid #E41B17;
      align-items: center;
      gap: 15px;
      max-width: 900px;
      color: #8B0000;
    }
    .item img {
      width: 120px;
      height: 120px;
      object-fit: contain;
      border-radius: 6px;
      border: 3px solid #8B0000;
    }
    .item-details {
      flex-grow: 1;
      text-align: right;
    }
    .item-qty input {
      width: 70px;
      font-size: 16px;
      padding: 3px 6px;
    }
    /* مودال التسجيل */
    #overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 11000;
    }
    #formModal {
      background: #fff;
      padding: 20px 25px;
      border-radius: 10px;
      max-width: 400px;
      text-align: center;
      color: #000;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }
    #formModal input {
      width: 90%;
      margin: 8px 0;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      color: #000;
      font-size: 16px;
    }
    #formModal button {
      margin-top: 12px;
      padding: 10px 20px;
      background: #E41B17;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 18px;
      cursor: pointer;
      font-weight: bold;
    }
    /* التذييل */
    footer {
      text-align: center;
      margin-top: 40px;
      padding: 20px;
      font-size: 14px;
      color: #8B0000;
      border-top: 2px solid #E41B17;
      user-select: none;
    }
    /* تبويب الرئيسية - النص في المنتصف */
    #home .content-center {
      max-width: 900px;
      margin: 20px auto;
      text-align: center;
      line-height: 1.6;
      font-size: 16px;
    }
    #home h2 {
      font-weight: bold;
      color: #8B0000;
      margin-bottom: 15px;
    }
    #home h3 {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <!-- شريط التبويبات -->
  <div id="tabBar">
    <button class="tabBtn active" data-tab="home">الرئيسية</button>
    <button class="tabBtn" data-tab="sales">مبيعات</button>
    <button class="tabBtn" data-tab="returns">مرتجعات</button>
    <button class="tabBtn" data-tab="contact">راسلنا</button>
  </div>

  <!-- شريط الأدوات (تحت شريط التبويبات) -->
  <div id="toolbar">
    <label for="imageSizeRange">حجم الصورة:</label>
    <input type="range" id="imageSizeRange" min="60" max="300" value="120" />
    <button id="editInfoBtn" title="تعديل بيانات العميل" onclick="showForm()">
      <img src="https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Up.png" alt="تعديل" />
    </button>
    <button id="sendWhatsappBtn" title="إرسال عبر واتساب" onclick="sendToWhatsApp()" disabled>
      <img src="https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Wt.png" alt="واتساب" />
    </button>
    <button id="printPdfBtn" title="طباعة الطلب PDF" onclick="printPDF()" disabled>
      <img src="https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Pd.png" alt="PDF" />
    </button>
  </div>

  <!-- محتوى التبويبات -->
  <div id="home" class="tabContent active">
    <img src="001.jpg" class="logo" alt="Aden Plastic logo" />
    <h2>شركة عدن الوطنية للصناعات المنزلية</h2>
    <div class="content-center">
      <h3>عن عدن للبلاستيك</h3>
      <p>
        تعد شركة عدن الوطنية للصناعات المنزلية المحدودة - المعروفة اختصاراً بـ " عدن بلاستيك" - واحدة من الشركات الصناعية الرائدة في مجال إنتاج الأدوات المنزلية وأدوات التعبئة والتغليف بالإضافة لمستلزمات الأثاث المنزلي. 
        منذ بدايتها الأولى عمدت شركة عدن إلى التميز من خلال التركيز على جودة منتجاتها وإرضاء عملائها، ولتحقيق ذلك عملت الشركة على تشجيع التجديد والابتكار في المنتجات وترسيخ ثقافة الاهتمام بالعميل، وبذلك وضعت شركة عدن نفسها كواحدة من الشركات الرائدة في هذا المجال بفضل اتباع سياستي الاهتمام بالمنتج والعميل. 
        تعتز شركة عدن أن منتجاتها تصنع من مواد خام أولية عالية الجودة تجلب من كبريات الشركات في هذا المجال، وتسويق منتجاتها في كل أرجاء اليمن من خلال شبكة واسعة من الموزعين ونقاط البيع، كما تستهدف الشركة الأسواق المجاورة في منطقة الخليج والقرن الأفريقي. 
        وتشمل منتجاتها على سبيل المثال لا الحصر البراميل، البوالد، السلات، حافظات الأطعمة، الصناديق، رفوف المطبخ، الكراسي والطاولات وغيرها. 
        تضع شركة عدن الوطنية موضوع الاستدامة في مقدمة أولوياتها، حيث تعمل جاهدة للحفاظ على البيئة والارتقاء بالجانب التصنيعي من خلال تقليل استنزاف الموارد واستخدام التكنولوجيا الحديثة بالإضافة إلى التحول إلى خيارات الطاقة البديلة.
      </p>
    </div>
  </div>

  <div id="sales" class="tabContent">
    <div id="items"></div>
  </div>

  <div id="returns" class="tabContent">
    <h3 style="text-align:center;">قسم المرتجعات</h3>
    <p style="max-width:800px; margin:auto; text-align:right;">
      هنا يمكنك إدارة المرتجعات الخاصة بالأصناف. هذه الخاصية تحت التطوير حالياً.
    </p>
  </div>

  <div id="contact" class="tabContent">
    <h3 style="text-align:center;">تواصل معنا</h3>
    <p style="max-width:800px; margin:auto; text-align:center;">
      لأي استفسار أو دعم، تواصل معنا عبر:<br/>
      الهاتف: 00967772299420<br/>
      البريد الإلكتروني: info@adenplastic.com<br/>
      العنوان: صنعاء - اليمن
    </p>
  </div>

  <!-- مودال تسجيل بيانات العميل -->
  <div id="overlay" style="display:none;">
    <div id="formModal">
      <h3>تسجيل معلومات العميل</h3>
      <input type="text" id="fullName" placeholder="الاسم الرباعي" required />
      <input type="text" id="businessName" placeholder="الاسم التجاري" required />
      <input type="text" id="address" placeholder="عنوان المحل" required />
      <input type="tel" id="phone" placeholder="رقم الهاتف" required />
      <button onclick="saveCustomerInfo()">حفظ</button>
    </div>
  </div>

  <!-- التذييل -->
  <footer>
    إعداد وبرمجة<br/>
    المميز سوفت للأنظمة المحاسبية المتكاملة<br/>
    م / مروان محمد عبد الله الذماري<br/>
    00967772299420
  </footer>

<script>
  // التبويبات
  const tabs = document.querySelectorAll('.tabBtn');
  const contents = document.querySelectorAll('.tabContent');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      const target = tab.dataset.tab;
      contents.forEach(c => c.classList.toggle('active', c.id === target));
    });
  });

  let customer = null;
  let itemsData = [];

  document.addEventListener('DOMContentLoaded', () => {
    loadCustomerInfo();
    fetchCSV();
    setupImageSizeControl();
  });

  // جلب بيانات CSV من GitHub
  function fetchCSV() {
    fetch('https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Data.csv')
      .then(res => res.text())
      .then(csvText => {
        const wb = XLSX.read(csvText, { type: 'string' });
        const sheet = wb.Sheets[wb.SheetNames[0]];
        itemsData = XLSX.utils.sheet_to_json(sheet);
        displayItems(itemsData);
      })
      .catch(err => {
        console.error('خطأ تحميل CSV:', err);
        alert('تعذر تحميل بيانات الأصناف من GitHub.');
      });
  }

  // عرض الأصناف
  function displayItems(items) {
    const div = document.getElementById('items');
    div.innerHTML = '';
    items.forEach(it => {
      const imageName = it.image?.trim() || '';
      const imageUrl = `https://raw.githubusercontent.com/T772299420/Aden_plaste/main/${imageName}`;
      const itemDiv = document.createElement('div');
      itemDiv.className = 'item';

      itemDiv.innerHTML = `
        <img src="${imageUrl}" alt="${it.name}" />
        <div class="item-details">
          <p>${it.name}</p>
          <label>الكمية: <input type="number" min="0" value="0" data-name="${it.name}" /></label>
        </div>
      `;
      div.appendChild(itemDiv);
    });

    updateButtonsState();
    attachQtyListeners();
  }

  // استماع لتغير الكمية لتفعيل/تعطيل الأزرار وتحديد الصورة
  function attachQtyListeners() {
    document.querySelectorAll('#items input[type=number]').forEach(input => {
      input.addEventListener('input', () => {
        updateButtonsState();
        highlightSelected(input);
      });
    });
  }

  // تمييز الصورة عند إدخال كمية أكبر من صفر
  function highlightSelected(input) {
    const val = parseInt(input.value);
    if (val > 0) {
      input.parentElement.parentElement.querySelector('img').style.borderColor = '#8B0000';
    } else {
      input.parentElement.parentElement.querySelector('img').style.borderColor = '#E41B17';
    }
  }

  // تفعيل وتعطيل أزرار الإرسال والطباعة
  function updateButtonsState() {
    const hasQty = Array.from(document.querySelectorAll('#items input[type=number]'))
      .some(input => parseInt(input.value) > 0);

    document.getElementById('sendWhatsappBtn').disabled = !hasQty;
    document.getElementById('printPdfBtn').disabled = !hasQty;
  }

  // التحكم بحجم الصور
  function setupImageSizeControl() {
    const range = document.getElementById('imageSizeRange');
    range.addEventListener('input', () => {
      const size = range.value;
      document.querySelectorAll('.item img').forEach(img => {
        img.style.width = size + 'px';
        img.style.height = size + 'px';
      });
    });
  }

  // تحميل بيانات العميل من localStorage
  function loadCustomerInfo() {
    const saved = localStorage.getItem('customerInfo');
    if (saved) {
      customer = JSON.parse(saved);
    } else {
      showForm();
    }
  }

  // عرض نافذة تسجيل بيانات العميل
  function showForm() {
    document.getElementById('overlay').style.display = 'flex';
    if (customer) {
      document.getElementById('fullName').value = customer.fullName;
      document.getElementById('businessName').value = customer.businessName;
      document.getElementById('address').value = customer.address;
      document.getElementById('phone').value = customer.phone;
    }
  }

  // حفظ بيانات العميل
  function saveCustomerInfo() {
    const fullName = document.getElementById('fullName').value.trim();
    const businessName = document.getElementById('businessName').value.trim();
    const address = document.getElementById('address').value.trim();
    const phone = document.getElementById('phone').value.trim();

    if (!fullName || !businessName || !address || !phone) {
      alert('يرجى تعبئة جميع الحقول.');
      return;
    }

    customer = { fullName, businessName, address, phone };
    localStorage.setItem('customerInfo', JSON.stringify(customer));
    document.getElementById('overlay').style.display = 'none';
  }

  // إرسال الطلب عبر واتساب مع بيانات العميل
  function sendToWhatsApp() {
    if (!customer) {
      alert('يرجى تسجيل بيانات العميل أولاً.');
      showForm();
      return;
    }

    const now = new Date();
    const dateStr = now.toLocaleDateString('ar-EG');

    let msg = `الأخوه مبيعات\n*شركه عدن الوطنيه للصناعات المنزلية*  المحترمون\n\n`;
    msg += `نحن / ${customer.businessName} ❚ عنهم الأخ / ${customer.fullName} ❚ العنوان / ${customer.address}\n\n`;
    msg += `نتقدم بطلب الأصناف التالية:\n`;

    document.querySelectorAll('#items input[type=number]').forEach(input => {
      const qty = parseInt(input.value);
