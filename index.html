<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø´Ø±ÙƒØ© Ø¹Ø¯Ù† Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„ØµÙ†Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©</title>

  <!-- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Ù…ÙƒØªØ¨Ø© xlsx Ù„ØªØ­Ù„ÙŠÙ„ Ù…Ù„ÙØ§Øª Excel/CSV -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <!-- ØªÙ†Ø³ÙŠÙ‚Ø§Øª CSS Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ù…ÙˆÙ‚Ø¹ -->
  <style>
    body {
      font-family: 'Times New Roman', serif;
      background: #FFFFF0; /* Ù„ÙˆÙ† Ø®Ù„ÙÙŠØ© ÙØ§ØªØ­ */
      margin: 0;
      color: #000;
      padding-top: 20px; /* Ù…Ø³Ø§Ø­Ø© ÙÙˆÙ‚ Ù„ØªÙØ§Ø¯ÙŠ Ø´Ø±ÙŠØ· Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
    }

    /* Ø´Ø±ÙŠØ· Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø¹Ù„ÙˆÙŠ */
    #tabBar {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: 50px;
      background: linear-gradient(to right, #E41B17, #8B0000);
      display: flex;
      justify-content: center;
      gap: 10px;
      align-items: center;
      z-index: 10000;
      flex-direction: row; /* Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† */
    }

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
    #tabBar button {
      background: transparent;
      border: none;
      color: #fff;
      font-weight: bold;
      font-size: 18px;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 6px;
      transition: background-color 0.3s ease;
    }

    /* ØªØ¨ÙˆÙŠØ¨ Ù†Ø´Ø· Ø£Ùˆ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± */
    #tabBar button.active,
    #tabBar button:hover {
      background: #fff;
      color: #8B0000;
      box-shadow: 0 0 8px #fff;
    }

    /* Ù…Ø­ØªÙˆÙ‰ ÙƒÙ„ ØªØ¨ÙˆÙŠØ¨ */
    .tabContent {
      display: none;
      max-width: 1000px;
      margin: 20px auto;
      padding: 20px;
      color: #000;
    }

    .tabContent.active {
      display: block;
    }

    /* ØªÙ†Ø³ÙŠÙ‚ Ø¹Ù†ØµØ± ØµÙ†Ù Ù…Ù†ØªØ¬ */
    .item {
      background: #fff;
      margin: 10px auto;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 5px #ccc;
      display: flex;
      border: 2px solid #E41B17;
      align-items: center;
      gap: 15px;
      max-width: 900px;
      color: #8B0000;
      flex-wrap: wrap;
    }

    /* ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ */
    .item img {
      width: 120px;
      height: auto;
      max-height: 300vw;
      object-fit: contain;
      border-radius: 6px;
      border: 3px solid #E41B17;
    }

    /* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ */
    .item-details {
      flex-grow: 1;
      text-align: right;
    }

    .item-details p {
      margin: 0 0 8px 0;
      font-weight: bold;
    }

    /* ØªÙ†Ø³ÙŠÙ‚ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
    .item-details label {
      display: block;
      margin-bottom: 6px;
      font-weight: normal;
    }

    .note-input {
      width: 100%;
      cursor: pointer;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 6px;
      color: #8B0000;
      font-size: 14px;
    }

    /* Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ */
    .whatsapp-button {
      display: block;
      margin: 20px auto;
      padding: 12px 24px;
      background-color: #25D366;
      color: white;
      font-weight: bold;
      border: none;
      border-radius: 50px;
      font-size: 18px;
      cursor: pointer;
      max-width: 300px;
    }

    /* Ø®Ù„ÙÙŠØ© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ */
    #overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 100000;
    }

    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
    #formModal {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      color: #000;
    }

    #formModal input {
      width: 90%;
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 16px;
      color: #000;
      direction: rtl;
    }

    #formModal button {
      margin-top: 15px;
      padding: 12px 30px;
      background: #E41B17;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
    }

    /* ØªÙ†Ø³ÙŠÙ‚ ØªØ¨ÙˆÙŠØ¨ "Ø¹Ù†Ø§" */
    #about p {
      max-width: 800px;
      margin: auto;
      text-align: justify;
      line-height: 1.6;
      color: #333;
      margin-bottom: 15px;
    }

    #about h3 {
      color: #8B0000;
      text-align: center;
      margin-top: 30px;
      margin-bottom: 10px;
    }

    #about p.contact {
      text-align: center;
      color: #333;
    }
  </style>
</head>
<body>

  <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
  <div id="tabBar">
    <button class="tabBtn active" data-tab="about">Ø¹Ù†Ø§</button>
    <button class="tabBtn" data-tab="client">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</button>
    <button class="tabBtn" data-tab="sales">Ø·Ù„Ø¨Ø§Øª</button>
    <button class="tabBtn" data-tab="returns">Ù…Ø±ØªØ¬Ø¹Ø§Øª</button>
  </div>

  <!-- ØªØ¨ÙˆÙŠØ¨ Ø¹Ù†Ø§ -->
  <div id="about" class="tabContent active">
    <h2 style="text-align:center; color:#8B0000;">Ø´Ø±ÙƒØ© Ø¹Ø¯Ù† Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„ØµÙ†Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©</h2>
    <div id="aboutContent">
      <p>...Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
    </div>
  </div>

  <!-- ØªØ¨ÙˆÙŠØ¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
  <div id="client" class="tabContent">
    <h2 style="text-align:center; color:#8B0000;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h2>
    <div id="clientData">
      <p><strong>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ:</strong> <span id="dispFullName"></span></p>
      <p><strong>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ:</strong> <span id="dispBusinessName"></span></p>
      <p><strong>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</strong> <span id="dispAddress"></span></p>
      <p><strong>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</strong> <span id="dispPhone"></span></p>
    </div>
    <button class="whatsapp-button" onclick="showCustomerForm()">ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</button>
  </div>

  <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª -->
  <div id="sales" class="tabContent">
    <h2 style="text-align:center; color:#8B0000;">Ù‚Ø³Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
    <div id="salesItems"></div>
    <button class="whatsapp-button" onclick="sendToWhatsApp()">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
  </div>

  <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª -->
  <div id="returns" class="tabContent">
    <h2 style="text-align:center; color:#8B0000;">Ù‚Ø³Ù… Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª</h2>
    <div id="returnsItems"></div>
    <button class="whatsapp-button" onclick="sendReturnsToWhatsApp()">ğŸ” Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
  </div>

  <!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
  <div id="overlay">
    <div id="formModal">
      <h3>ØªØ³Ø¬ÙŠÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
      <input type="text" id="fullName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ" required />
      <input type="text" id="businessName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ" required />
      <input type="text" id="address" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­Ù„" required />
      <input type="tel" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required />
      <button onclick="saveCustomerInfo()">Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>
  </div>

  <!-- ÙƒÙˆØ¯ JavaScript Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ -->
  <script>
    // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
    const tabs = document.querySelectorAll('#tabBar button');
    const contents = document.querySelectorAll('.tabContent');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        contents.forEach(c => c.classList.remove('active'));
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    let customer = null;
    let itemsData = [];

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', () => {
      loadCustomerInfo();
      fetchCSV(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙ†Ø§Ù
      loadAboutTextFromCSV(); // ØªØ­Ù…ÙŠÙ„ Ù†Øµ "Ø¹Ù†Ø§"
      tabs[0].click(); // ÙØªØ­ ØªØ¨ÙˆÙŠØ¨ "Ø¹Ù†Ø§"
    });

    // ØªØ­Ù…ÙŠÙ„ Ù†Øµ "Ø¹Ù†Ø§" Ù…Ù† CSV
    function loadAboutTextFromCSV() {
      fetch('https://raw.githubusercontent.com/T772299420/Aden_plaste/main/address.csv')
        .then(res => res.text())
        .then(csvText => {
          const lines = csvText.split(/\r?\n/).filter(line => line.trim() !== '');
          let aboutText = '';
          lines.forEach(line => {
            const cells = line.split(',');
            aboutText += `<p>${cells[0]}</p>`;
          });
          document.getElementById('aboutContent').innerHTML = aboutText;
        })
        .catch(err => {
          console.error('Ø®Ø·Ø£ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù address.csv:', err);
          document.getElementById('aboutContent').innerHTML = '<p>ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù† Ø§Ù„Ø´Ø±ÙƒØ©.</p>';
        });
    }

    // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø£ØµÙ†Ø§Ù
    function fetchCSV() {
      fetch('https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Data.csv')
        .then(res => res.text())
        .then(csvText => {
          const wb = XLSX.read(csvText, { type: 'string' });
          const sheet = wb.Sheets[wb.SheetNames[0]];
          itemsData = XLSX.utils.sheet_to_json(sheet);
          renderSalesItems();
          renderReturnsItems();
        })
        .catch(err => {
          console.error('Ø®Ø·Ø£ ØªØ­Ù…ÙŠÙ„ CSV:', err);
          alert('ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù Ù…Ù† GitHub.');
        });
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ø£ØµÙ†Ø§Ù ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    function renderSalesItems() {
      const container = document.getElementById('salesItems');
      container.innerHTML = '';
      itemsData.forEach(item => {
        const name = item.name?.trim();
        const image = item.image?.trim() || '';
        const imgUrl = `https://raw.githubusercontent.com/T772299420/Aden_plaste/main/${image.includes('.') ? image : image + '.jpg'}`;
        container.innerHTML += `
          <div class="item">
            <img src="${imgUrl}" alt="${name}" />
            <div class="item-details">
              <p>${name}</p>
              <label>Ø§Ù„ÙƒÙ…ÙŠØ©: <input type="number" min="0" value="" data-name="${name}" /></label>
            </div>
          </div>
        `;
      });
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ø£ØµÙ†Ø§Ù ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
    function renderReturnsItems() {
      const container = document.getElementById('returnsItems');
      container.innerHTML = '';
      itemsData.forEach(item => {
        const name = item.name?.trim();
        const image = item.image?.trim() || '';
        const imgUrl = `https://raw.githubusercontent.com/T772299420/Aden_plaste/main/${image.includes('.') ? image : image + '.jpg'}`;
        container.innerHTML += `
          <div class="item">
            <img src="${imgUrl}" alt="${name}" />
            <div class="item-details">
              <p>${name}</p>
              <label>Ø§Ù„ÙƒÙ…ÙŠØ©: <input type="number" min="0" value="" data-name="${name}" /></label>
              <label>Ù…Ù„Ø§Ø­Ø¸Ø©: <input readonly onclick="openNoteDialog(this)" placeholder="Ø§Ø¶ØºØ· Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù…Ù„Ø§Ø­Ø¸Ø©" class="note-input" /></label>
            </div>
          </div>
        `;
      });
    }

    // Ø¥Ø¯Ø®Ø§Ù„ Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ù…Ø±ØªØ¬Ø¹
    function openNoteDialog(input) {
      const note = prompt('Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ø£Ùˆ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©:');
      if (note !== null) input.value = note;
    }

    // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
    function loadCustomerInfo() {
      const saved = localStorage.getItem('customerInfo');
      if (saved) {
        customer = JSON.parse(saved);
        displayCustomerInfo();
      } else {
        showCustomerForm();
      }
    }

    // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
    function displayCustomerInfo() {
      document.getElementById('dispFullName').textContent = customer.fullName || '';
      document.getElementById('dispBusinessName').textContent = customer.businessName || '';
      document.getElementById('dispAddress').textContent = customer.address || '';
      document.getElementById('dispPhone').textContent = customer.phone || '';
    }

    // Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
    function showCustomerForm() {
      if(customer) {
        document.getElementById('fullName').value = customer.fullName || '';
        document.getElementById('businessName').value = customer.businessName || '';
        document.getElementById('address').value = customer.address || '';
        document.getElementById('phone').value = customer.phone || '';
      }
      document.getElementById('overlay').style.display = 'flex';
    }

    // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙÙŠ localStorage
    function saveCustomerInfo() {
      const fullName = document.getElementById('fullName').value.trim();
      const businessName = document.getElementById('businessName').value.trim();
      const address = document.getElementById('address').value.trim();
      const phone = document.getElementById('phone').value.trim();

      if (!fullName || !businessName || !address || !phone) {
        alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.');
        return;
      }

      customer = { fullName, businessName, address, phone };
      localStorage.setItem('customerInfo', JSON.stringify(customer));
      displayCustomerInfo();
      document.getElementById('overlay').style.display = 'none';
      alert('ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„');
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
    function sendToWhatsApp() {
      if (!customer) {
        alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.');
        showCustomerForm();
        return;
      }

      let message = `Ø·Ù„Ø¨ Ù…Ù†: ${customer.fullName}\n`;
      message += `Ø§Ù„Ø§Ø³Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ: ${customer.businessName}\n`;
      message += `Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${customer.address}\n`;
      message += `Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${customer.phone}\n\n`;
      message += 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨:\n';

      let hasOrder = false;

      document.querySelectorAll('#salesItems .item').forEach(item => {
        const name = item.querySelector('input[type=number]').dataset.name;
        const qty = parseInt(item.querySelector('input[type=number]').value) || 0;
        if (qty > 0) {
          hasOrder = true;
          message += `${name}: ${qty}\n`;
        }
      });

      if (!hasOrder) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ…ÙŠØ§Øª Ù„Ù„Ø·Ù„Ø¨Ø§Øª.');
        return;
      }

      const encodedMessage = encodeURIComponent(message);
      const phone = "967772299420";
      const url = `https://wa.me/${phone}?text=${encodedMessage}`;
      window.open(url, '_blank');
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
    function sendReturnsToWhatsApp() {
      if (!customer) {
        alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.');
        showCustomerForm();
        return;
      }

      let message = `Ù…Ø±ØªØ¬Ø¹Ø§Øª Ù…Ù†: ${customer.fullName}\n`;
      message += `Ø§Ù„Ø§Ø³Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ: ${customer.businessName}\n`;
      message += `Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${customer.address}\n`;
      message += `Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${customer.phone}\n\n`;
      message += 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª:\n';

      let hasReturns = false;

      document.querySelectorAll('#returnsItems .item').forEach(item => {
        const name = item.querySelector('input[type=number]').dataset.name;
        const qty = parseInt(item.querySelector('input[type=number]').value) || 0;
        const note = item.querySelector('.note-input').value.trim();
        if (qty > 0) {
          hasReturns = true;
          message += `${name}: ${qty}`;
          if (note) message += ` | Ù…Ù„Ø§Ø­Ø¸Ø©: ${note}`;
          message += `\n`;
        }
      });

      if (!hasReturns) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ…ÙŠØ§Øª Ø£Ùˆ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª.');
        return;
      }

      const encodedMessage = encodeURIComponent(message);
      const phone = "967772299420";
      const url = `https://wa.me/${phone}?text=${encodedMessage}`;
      window.open(url, '_blank');
    }
  </script>
</body>
  </html>
