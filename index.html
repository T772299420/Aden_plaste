<!DOCTYPE html>
<html lang="ar" dir="rtl">
  
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø´Ø±ÙƒØ© Ø¹Ø¯Ù† Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„ØµÙ†Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  
  
  
  
  <style>
 #btnCloseGroups {
  position: absolute;
  top: 20%;
  right: 15px;
  transform: translateY(-100%);
  width: 64px;
  height: 64px;
  background: linear-gradient(135deg, #ff4e50, #8B0000);
  color: #8B0000;
  border: none;
  border-radius: 50%;
  display: none;
  align-items: center;
  justify-content: center;
  font-size: 280px;
  font-weight: bold;
  cursor: pointer;
  z-index: 2000;
  box-shadow: 0 100px 250px rgba(255, 78, 80, 0.6);
  transition: all 0.3s ease;
  user-select: none;
}

#btnCloseGroups:hover {
  background: linear-gradient(189deg, #8B0000, #8B0000);
  transform: translateY(-100%) scale(1.1);
  box-shadow: 0 14px 30px #8B0000(29, 21, 35, 0.8);
}

    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f9f9f9; margin: 0; padding: 0; color: #333; }
    h2 { color: #8B0000; margin-bottom: 20px; font-weight: 700; text-align: center; }
    
   

#pageFooter {
  position: fixed;
  bottom: 0;
  width: 100%;
  z-index: 1001;
}
    
    #tabBar {
      background: #8B0000; display: flex; align-items: center;
      padding: 10px 15px; gap: 15px; flex-wrap: wrap; position: sticky; top: 0; z-index: 1000;
    }
    .tab {
  font-size: 18px;
  cursor: pointer;
  padding: 10px 18px;
  border-radius: 8px;
  background-color: #8B0000;
  color: white;
  margin-left: 5px;
  display: inline-block;
  transition: background-color 0.3s;
}
.tab:hover {
  background-color: #a30000;
}

    #tabBar button.tabBtn {
      background: transparent; border: none; color: #fff;
      font-size: 18px; cursor: pointer; padding: 10px 18px; border-radius: 8px;
    }
    #tabBar button.tabBtn.active, #tabBar button.tabBtn:hover {
      background: #f44336;
    }
    .search-container {
      margin-left: auto; display: flex; align-items: center; gap: 10px;
    }
    #searchInput {
      padding: 7px 12px; font-size: 16px; border-radius: 8px; border: none; width: 200px;
    }
    #searchBtn, #btnClientInfo {
      padding: 9px 14px; border-radius: 8px; cursor: pointer;
      font-size: 16px; border: none; color: #fff;
    }
    #searchBtn { background: #f44336; }
    #btnClientInfo { background: #004d40; margin-left: 10px; }
    .tabContent {
      display: none; padding: 20px; max-width: 1100px; margin: auto; background: white;
    }
    .tabContent.active { display: block; }
    .group-section { margin-bottom: 20px; }
    .group-header {
      background: #8B0000;
      background: rgba(139, 0, 0, 0.1); /* Ø®Ù„ÙÙŠØ© Ø­Ù…Ø±Ø§Ø¡ Ø´ÙØ§ÙØ© Ø¨Ù†Ø³Ø¨Ø© 10% */
      color: #8B0000; padding: 12px 18px; font-size: 1.2rem; font-weight: bold;
      border: 2px solid #8B0000;
      cursor: pointer; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;
    }
      .group-header {
  background: linear-gradient(190deg, rgba(190, 0, 0, 0.8), rgba(255, 255, 255, 0.1));
  color: white;
  padding: 12px 18px;
  font-size: 1.2rem;
  font-weight: bold;
  border: 2px solid #8B0000;
  font-size: 1.3rem; /* ØªÙ… ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø· */
  font-weight: bold;
  cursor: pointer;
  border-radius: 8px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  backdrop-filter: brightness(1.2);
  box-shadow: 0 0 10px #8B0000(1, 0, 0, 0.3);
}
    
    
    .group-items {
      display: grid; grid-template-columns: repeat(auto-fill,minmax(230px,1fr));
      gap: 20px; padding: 15px 10px;
    }
    .group-collapsed .group-items { display: none; }
    .group-arrow { font-size: 1.4rem; transition: transform 0.3s ease; }
    .group-collapsed .group-arrow { transform: rotate(90deg); }
    .item {
      border: 1px solid #ccc; padding: 10px; border-radius: 8px; background: #fefefe;
    }
    .item.highlighted { border-color: #f44336; background: #fff0f0; }
    .image-box img {
      width: 100%; height: 200px; object-fit: contain;
    }
    .item-details { display: flex; flex-direction: column; gap: 8px; }
    .item-controls { display: flex; align-items: center; gap: 10px; }
    .notes-btn {
      background-color: #2196f3;
      border: none; color: white;
      padding: 5px 10px; border-radius: 6px;
      cursor: pointer; font-size: 14px;
    }
    mark {
      background: yellow; color: black; padding: 0 4px;
    }
    #bottomBar {
      position: fixed; bottom: 0; width: 100%; background: #fff;
      border-top: 1px solid #ccc; display: flex; justify-content: center;
      gap: 10px; padding: 10px; z-index: 1000;
    }
    #bottomBar button {
      padding: 10px 16px; font-size: 16px;
      border: none; border-radius: 8px;
      cursor: pointer; color: white;
    }
    #btnNewOrder { background-color: #FF9800; }
    #showOrderBtn { background-color: #2196F3; }
    #whatsappBtn { background-color: #25d366; }
    #bottomBar {
  position: fixed;
  bottom: 40px; /* ØªÙ… Ø±ÙØ¹Ù‡ ÙÙˆÙ‚ Ø§Ù„ÙÙˆØªØ± */
  right: 0;
  left: 0;
  background-color: #f9f9f9;
  padding: 8px;
  text-align: center;
  z-index: 999;
  border-top: 1px solid #ccc;
}

#footerInfo {
  position: fixed;
  bottom: 0;
  right: 0;
  left: 0;
  background-color: #8B0000;
  color: white;
  text-align: center;
  padding: 5px 10px;
  font-size: 14px;
  z-index: 998;
  white-space: nowrap;
  overflow-x: auto;
}

#footerInfo a {
  color: white;
  text-decoration: none;
  margin: 0 5px;
}
    .logo {
  height: 48px;                /* Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø´Ø¹Ø§Ø± */
  border-radius: 10px;         /* Ø²ÙˆØ§ÙŠØ§ Ù…Ø³ØªØ¯ÙŠØ±Ø© */
  box-shadow: 0 2px 5px rgba(0,0,0,0.3); /* Ø¸Ù„ Ø¨Ø³ÙŠØ· ØªØ­Øª Ø§Ù„ØµÙˆØ±Ø© */
  margin-inline-start: 10px;   /* Ù…Ø³Ø§ÙØ© Ù…Ù† Ø¬Ù‡Ø© Ø§Ù„ÙŠØ³Ø§Ø± ÙÙŠ ØªØ®Ø·ÙŠØ· RTL */
  background: white;           /* Ø®Ù„ÙÙŠØ© Ø¨ÙŠØ¶Ø§Ø¡ Ø­ÙˆÙ„ Ø§Ù„Ø´Ø¹Ø§Ø± */
  padding: 4px;      /* Ø­Ø´Ùˆ Ø¯Ø§Ø®Ù„ÙŠ */
}
<style>

  .search-container {
    display: flex;
    justify-content: center;
    margin: 10px 0;
  }
/*Ø­Ø¬Ù… Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¨Ø­Ø« */
  #searchInput {
    width: 200px;      /* Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù‚Ù„ */
    height: 40px;      /* Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø­Ù‚Ù„ */
    font-size: 18px;   /* Ø­Ø¬Ù… Ø§Ù„Ø®Ø· */
    padding: 8px 12px; /* Ù…Ø³Ø§Ø­Ø© Ø¯Ø§Ø®Ù„ÙŠØ© */
    border: 2px solid #8B0000; /* Ø¥Ø·Ø§Ø± Ø£Ù†ÙŠÙ‚ Ø¨Ù„ÙˆÙ† Ø£Ø­Ù…Ø± ØºØ§Ù…Ù‚ */
    border-radius: 10px;
    outline: none;
  }


  #searchInput::placeholder {
    color: #aaa;
    font-size: 16px;
  }
</style>
  </style>
</head>
<body>
  <div id="tabBar">
   <button class="tabBtn active" data-tab="sales" style="color: white; border: 2px solid white; border-radius: 8px;">
  <i class="fa fa-shopping-cart" aria-hidden="true" style="margin-left:8px;"></i> Ø§Ù„Ø·Ù„Ø¨Ø§Øª
</button>
  <button class="tabBtn" data-tab="client" style="color: white; border: 2px solid white;">
  <i class="fas fa-user" style="margin-left: 5px;"></i>
  Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
</button>
        <!-- ØªØ¨ÙˆÙŠØ¨ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØªÙ„ÙˆØ¬ -->
  <!-- Ø²Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØªÙ„ÙˆØ¬ Ù…Ø¹ Ø£ÙŠÙ‚ÙˆÙ†Ø© FontAwesome -->
<button class="tab" onclick="confirmDownload()" style="cursor: pointer; color: white; border: 2px solid white;">
  <i class="fas fa-download" style="margin-left: 5px;"></i> 
</button>

<script>
  function confirmDownload() {
    const confirmed = confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ­Ù…ÙŠÙ„ ÙƒØªÙ„ÙˆØ¬ Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŸ");
    if (confirmed) {
      window.open("https://github.com/T772299420/Aden_plaste/raw/main/%D9%83%D8%AA%D9%84%D9%88%D8%AC%20%D8%A7%D9%84%D9%85%D9%86%D8%AA%D8%AC%D8%A7%D8%AA%20%D9%8A%D9%88%D9%86%D9%8A%D9%88%202025.pdf", "_blank");
    }
  }
</script>
    <div class="search-container">
      <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ØµÙ†Ù..." />
      <!-- Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„Ø²Ø± Ø¶Ù…Ù† Ø´Ø±ÙŠØ· Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->


<style>
  .tab {
    font-size: 18px;
    cursor: pointer;
    padding: 10px 18px;
    border-radius: 8px;
    background-color: #8B0000;
    color: white;
    margin-left: 5px;
    display: inline-block;
    transition: background-color 0.3s;
  }
  .tab:hover {
    background-color: #a30000;
  }
</style>
     
      <img class="logo" src="https://raw.githubusercontent.com/T772299420/Aden_plaste/main/logo.png" alt="Logo" />
    </div>
  </div>

<div id="sales" class="tabContent active">
  <div class="section-header">
    <h2>ğŸ›’ Ù‚Ø³Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
    <p>ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„ÙƒÙ„ ØµÙ†Ù Ø«Ù… Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨.</p>
  </div>
  <div id="salesItems" class="items-container"></div>
</div>

  <div id="client" class="tabContent">
    <h2>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h2>
    <div>
      <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ:</label><input type="text" id="clientFullName" /><br><br>
      <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ:</label><input type="text" id="clientTradeName" /><br><br>
      <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­Ù„:</label><input type="text" id="clientAddress" /><br><br>
      <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label><input type="text" id="clientPhone" dir="ltr" /><br><br>
      <button id="saveClientInfoBtn" class="btn-yes">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>
  </div>

<div id="bottomBar">
  <!-- Ø²Ø± Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª -->
<button id="btnCloseGroups" style="background-color: red; color: white; border-radius: 50%; padding: 10px; font-size: 20px; display: none;">
  Ã—
</button>
  <button id="btnNewOrder">ğŸ—‘ï¸ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</button>
  
  <button id="showOrderBtn" style="display:none;">ğŸ“„ Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨</button>
  <button id="whatsappBtn" style="display:none;">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
</div>

<!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø£Ø³ÙÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
<div id="footerInfo">
  Ø§Ù„Ù…Ù…ÙŠØ² Ø³ÙˆÙØª Ù„Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©   
  <a href="https://wa.me/967772299420" target="_blank">ğŸ“ +967 772299420</a> 
  <a h
</div>

  
  <script>
function downloadCatalog() {
  const url = 'https://github.com/T772299420/Aden_plaste/raw/main/%D9%83%D8%AA%D9%84%D9%88%D8%AC%20%D8%A7%D9%84%D9%85%D9%86%D8%AA%D8%AC%D8%A7%D8%AA%20%D9%8A%D9%88%D9%86%D9%8A%D9%88%202025.pdf';
  const link = document.createElement('a');
  link.href = url;
  link.download = 'ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.pdf'; // Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø¹Ù†Ø¯ Ø§Ù„ØªÙ†Ø²ÙŠÙ„
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}


  let itemsData = [];
let savedQuantities = JSON.parse(localStorage.getItem('selectedQuantities') || '{}');
let savedItemNotes = JSON.parse(localStorage.getItem('itemNotes') || '{}');
let clientInfo = JSON.parse(localStorage.getItem('clientInfo') || '{}');
let groupStates = {};
let lastOpenedGroup = '';

document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('btnCloseGroups').onclick = () => {
  // ØºÙ„Ù‚ ÙƒÙ„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª
  groupStates = {};
  lastOpenedGroup = '';

  // Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
  document.getElementById('btnCloseGroups').style.display = 'none';

  // Ø¥Ø¹Ø§Ø¯Ø© ØªØµÙ†ÙŠÙ ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙƒÙ…ØºÙ„Ù‚Ø©
  document.querySelectorAll('.group-section').forEach(section => {
    section.classList.add('group-collapsed');
  });
};
  fetch('https://raw.githubusercontent.com/T772299420/Aden_plaste/main/data%20(7).csv')
    .then(res => res.text())
    .then(text => {
      const rows = text.trim().split('\n').map(row => row.split(','));
      const headers = rows.shift();
      itemsData = rows.map(row => {
  const obj = {};
  headers.forEach((h, i) => obj[h.trim().toLowerCase()] = row[i]?.trim() || '');
  obj._priority = parseFloat(row[5]) || 0; // Ø§Ù„Ø¹Ù…ÙˆØ¯ F Ù‡Ùˆ Ø§Ù„Ø³Ø§Ø¯Ø³ (index 5)
  return obj;
});

// ØªØ±ØªÙŠØ¨ ØªØµØ§Ø¹Ø¯ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø³Ø§Ø¯Ø³ (Ø§Ù„Ø°ÙŠ Ø£Ø¶ÙÙ†Ø§Ù‡ Ø¨Ø§Ø³Ù… _priority)
itemsData.sort((a, b) => a._priority - b._priority);
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
      fillClientInputs();
      if (!clientInfo.fullName || !clientInfo.phone) {
        alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
        switchToTab("client");
      }
      
      if (Object.keys(savedQuantities).length > 0) {
        if (confirm("ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨ Ù…Ø­ÙÙˆØ¸ Ù…Ø³Ø¨Ù‚Ù‹Ø§ØŒ Ù‡Ù„ ØªØ±ØºØ¨ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ØŸ")) {
          clearOrder();
        }
      }
      
      renderSalesItems();
      updateButtonsVisibility();
    });
  
  document.getElementById('searchInput').addEventListener('input', (e) => {
    const keyword = e.target.value.trim().toLowerCase();
    renderSalesItems(keyword);
  });
  
  document.getElementById('saveClientInfoBtn').onclick = () => {
    clientInfo = {
      fullName: document.getElementById('clientFullName').value.trim(),
      tradeName: document.getElementById('clientTradeName').value.trim(),
      address: document.getElementById('clientAddress').value.trim(),
      phone: document.getElementById('clientPhone').value.trim(),
    };
    localStorage.setItem('clientInfo', JSON.stringify(clientInfo));
    alert("ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„");
  };
  
  document.querySelectorAll('.tabBtn').forEach(btn => {
    btn.addEventListener('click', () => {
      const targetTab = btn.dataset.tab;
      if (targetTab === 'sales' && (!clientInfo.fullName || !clientInfo.phone)) {
        alert("Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù‚Ø¨Ù„ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„.");
        switchToTab("client");
        return;
      }
      switchToTab(targetTab);
    });
  });
  
  document.getElementById('btnNewOrder').onclick = () => {
    if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¨Ø¯Ø¡ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ØŸ")) {
      clearOrder();
      renderSalesItems();
      updateButtonsVisibility();
    }
  };
  
document.getElementById('showOrderBtn').onclick = () => {
  const items = Object.keys(savedQuantities);
  if (!items.length) return alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ØµÙ†Ø§Ù Ù…Ø®ØªØ§Ø±Ø©.");

  if (messagePages && messagePages.length > 0) {
    const currentMsg = messagePages[currentPage] || '';
    return alert(`Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ - ØµÙØ­Ø© ${currentPage + 1}:\n\n${currentMsg}`);
  }

  // ÙÙŠ Ø­Ø§Ù„ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚Ø³ÙŠÙ…ØŒ Ù†Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙŠØ¯ÙˆÙŠÙ‹Ø§
  let msg = "Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ:\n\n";
  items.forEach(name => {
    msg += `- ${name}: ${savedQuantities[name]}`;
    if (savedItemNotes[name]) msg += ` (Ù…Ù„Ø§Ø­Ø¸Ø©: ${savedItemNotes[name]})`;
    msg += '\n';
  });

  alert(msg);
};

  const MAX_WHATSAPP_LENGTH = 3900; // Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø±Ø³Ù…ÙŠ

let currentPage = 0;
let messagePages = [];

function paginateMessage(message) {
  const pages = [];
  let start = 0;
  while (start < message.length) {
    pages.push(message.substring(start, start + MAX_WHATSAPP_LENGTH));
    start += MAX_WHATSAPP_LENGTH;
  }
  return pages;
}

function renderPaginationControls() {
  let container = document.getElementById('paginationControls');
  if (!container) {
    container = document.createElement('div');
    container.id = 'paginationControls';
    container.style.textAlign = 'center';
    container.style.marginTop = '10px';
    document.getElementById('bottomBar').appendChild(container);
  }
  container.innerHTML = '';

  if (messagePages.length <= 1) return;

  for (let i = 0; i < messagePages.length; i++) {
    const btn = document.createElement('button');
    btn.textContent = `ØµÙØ­Ø© ${i + 1}`;
    btn.style.margin = '0 5px';
    btn.style.padding = '6px 12px';
    btn.style.borderRadius = '6px';
    btn.style.border = '1px solid #8B0000';
    btn.style.background = (i === currentPage) ? '#8B0000' : 'white';
    btn.style.color = (i === currentPage) ? 'white' : '#8B0000';
    btn.style.cursor = 'pointer';
    btn.onclick = () => {
      currentPage = i;
      renderPaginationControls();
    };
    container.appendChild(btn);
  }
}

document.getElementById('whatsappBtn').onclick = () => {
  if (!Object.keys(savedQuantities).length) return alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ØµÙ†Ø§Ù.");
  if (!clientInfo.phone) return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø£ÙˆÙ„Ù‹Ø§.");
  const date = new Date().toISOString().split('T')[0];
  let msg = `Ø£Ù†Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ / ${clientInfo.fullName || ''} - ${clientInfo.tradeName || ''}\n`;
  msg += `Ø¹Ù†ÙˆØ§Ù†ÙŠ / ${clientInfo.address || ''}\nØ±Ù‚Ù… Ù‡Ø§ØªÙÙŠ / ${clientInfo.phone || ''}\nØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨ / ${date}\n`;
  msg += `__________________________\nØ§Ù„Ø§ØµÙ†Ø§Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:\n`;
  Object.keys(savedQuantities).forEach(name => {
    const item = itemsData.find(i => i.name === name);
    const unit = item?.unit || 'ÙˆØ­Ø¯Ø©';
    const qty = savedQuantities[name];
    const note = savedItemNotes[name] ? ` - Ù…Ù„Ø§Ø­Ø¸Ø©: ${savedItemNotes[name]}` : '';
    msg += `- ${name} - ${unit} - ${qty}${note}\n`;
  });

  // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ ØµÙØ­Ø§Øª
  messagePages = paginateMessage(msg);

  if (currentPage >= messagePages.length) currentPage = 0;

  // Ø£Ø¸Ù‡Ø± Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØµÙØ­Ø§Øª
  renderPaginationControls();

  // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙ‚Ø·
  const encodedMsg = encodeURIComponent(messagePages[currentPage]);
  const url = `https://wa.me/967771334747?text=${encodedMsg}`;
  window.open(url, '_blank');
};

});

function switchToTab(tabName) {
  document.querySelectorAll('.tabBtn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.tabContent').forEach(tab => tab.classList.remove('active'));
  document.querySelector(`.tabBtn[data-tab="${tabName}"]`).classList.add('active');
  document.getElementById(tabName).classList.add('active');
}

function renderSalesItems(keyword = '') {
  const container = document.getElementById('salesItems');
  container.innerHTML = '';
  const groups = {};
  
  itemsData.forEach(item => {
    const group = item.group || 'Ø£Ø®Ø±Ù‰';
    if (!groups[group]) groups[group] = [];
    groups[group].push(item);
  });
  
  Object.entries(groups).forEach(([group, items]) => {
    const matchedItems = keyword ?
      items.filter(i => i.name.toLowerCase().includes(keyword)) :
      items;
    
    if (keyword && matchedItems.length === 0) return;
    
    const section = document.createElement('div');
    section.className = 'group-section';
    
    const selectedCount = items.filter(i => savedQuantities[i.name]).length;
    const header = document.createElement('div');
    header.className = 'group-header';
    header.innerHTML = `<span>${group} - Ø§Ù„Ø¹Ø¯Ø¯ ${items.length}</span>
<span class="group-arrow"><i class="fas fa-angle-double-down" style="color: #8B0000;"></i></span>`;

    header.onclick = () => {
  const collapsed = section.classList.toggle('group-collapsed');
  groupStates[group] = !collapsed;
  if (!collapsed) lastOpenedGroup = group;
  
  // Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ØŒ Ù†ØªØ­Ù‚Ù‚ Ù‡Ù„ Ù‡Ù†Ø§Ùƒ Ø£ÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…ÙØªÙˆØ­Ø© Ù„Ù†Ø¸Ù‡Ø± Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
  const anyGroupOpen = Object.values(groupStates).some(state => state === true);
  document.getElementById('btnCloseGroups').style.display = anyGroupOpen ? 'inline-block' : 'none';
};

    const itemsContainer = document.createElement('div');
    itemsContainer.className = 'group-items';
    
    matchedItems.forEach(item => {
      const name = item.name;
      const unit = item.unit || 'ÙˆØ­Ø¯Ø©';
      const image = item.image || '';
      const imgUrl = `https://raw.githubusercontent.com/T772299420/Aden_plaste/main/${image}`;
      const qty = savedQuantities[name] || '';
      const note = savedItemNotes[name] || '';
      
      const card = document.createElement('div');
      card.className = `item ${qty ? 'highlighted' : ''}`;
      card.innerHTML = `
        <div class="image-box"><img src="${imgUrl}" alt="${name}" /></div>
        <div class="item-details">
        <p>${highlightKeyword(name, keyword)} (${unit}) ${qty ? 'ğŸ‘' : ''}</p>
          <div class="item-controls">
            <label>Ø§Ù„ÙƒÙ…ÙŠØ©:
              <input type="number" dir="ltr" min="0" value="${qty}" data-name="${name}" oninput="onQuantityChange(this)" />
            </label>
            <button class="notes-btn" onclick="addNote('${name}')">Ù…Ù„Ø§Ø­Ø¸Ø§Øª${note ? ' âœ“' : ''}</button>
          </div>
        </div>`;
      itemsContainer.appendChild(card);
    });
    
    section.appendChild(header);
    section.appendChild(itemsContainer);
    
    const shouldOpen = keyword ?
      true :
      (group === lastOpenedGroup || groupStates[group]);
    
    if (!shouldOpen) section.classList.add('group-collapsed');
    container.appendChild(section);
  });
}

function onQuantityChange(input) {
  const qty = parseInt(input.value) || 0;
  const name = input.dataset.name;
  const card = input.closest('.item');
  
  if (qty > 0) {
    savedQuantities[name] = qty;
    card.classList.add('highlighted');
  } else {
    delete savedQuantities[name];
    delete savedItemNotes[name];
    card.classList.remove('highlighted');
  }
  
  const titleElement = input.closest('.item-details').querySelector('p');
  if (titleElement) {
    const unit = itemsData.find(i => i.name === name)?.unit || 'ÙˆØ­Ø¯Ø©';
    const keyword = document.getElementById('searchInput').value.trim().toLowerCase();
    titleElement.innerHTML = `${highlightKeyword(name, keyword)} (${unit}) ${qty ? 'ğŸ‘' : ''}`;
  }
  
  localStorage.setItem('selectedQuantities', JSON.stringify(savedQuantities));
  localStorage.setItem('itemNotes', JSON.stringify(savedItemNotes));
  updateButtonsVisibility();
}

function addNote(name) {
  const note = prompt("Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©:", savedItemNotes[name] || '');
  if (note !== null) {
    if (note.trim()) savedItemNotes[name] = note.trim();
    else delete savedItemNotes[name];
    localStorage.setItem('itemNotes', JSON.stringify(savedItemNotes));
    renderSalesItems(document.getElementById('searchInput').value.trim().toLowerCase());
  }
}

function highlightKeyword(text, keyword) {
  if (!keyword) return text;
  return text.replace(new RegExp(`(${keyword})`, 'gi'), `<mark>$1</mark>`);
}

function fillClientInputs() {
  document.getElementById('clientFullName').value = clientInfo.fullName || '';
  document.getElementById('clientTradeName').value = clientInfo.tradeName || '';
  document.getElementById('clientAddress').value = clientInfo.address || '';
  document.getElementById('clientPhone').value = clientInfo.phone || '';
}

function clearOrder() {
  savedQuantities = {};
  savedItemNotes = {};
  localStorage.removeItem('selectedQuantities');
  localStorage.removeItem('itemNotes');
  updateButtonsVisibility();
// Ø­Ø°Ù Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØµÙØ­Ø§Øª Ø¹Ù†Ø¯ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
  const paginationContainer = document.getElementById('paginationControls');
  if (paginationContainer) {
    paginationContainer.innerHTML = '';
  }
  currentPage = 0; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
}


function updateButtonsVisibility() {
  const visible = Object.keys(savedQuantities).length > 0;
  document.getElementById('showOrderBtn').style.display = visible ? 'inline-block' : 'none';
  document.getElementById('whatsappBtn').style.display = visible ? 'inline-block' : 'none';
}
</script> 
</body>
</html>
    
