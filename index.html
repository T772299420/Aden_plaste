<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>شركة عدن الوطنية للصناعات المنزلية</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #FFFFF0;
      margin: 0;
      color: #8B0000;
      padding-top: 100px;
    }
    #tabBar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: #E41B17;
      display: flex;
      justify-content: space-around;
      align-items: center;
      z-index: 10000;
    }
    #tabBar button {
      background: none;
      border: none;
      color: #FFFFF0;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
      padding: 10px 15px;
      border-bottom: 3px solid transparent;
      transition: border-bottom-color 0.3s ease;
    }
    #tabBar button.active {
      border-bottom-color: #8B0000;
    }
    .tabContent {
      display: none;
      max-width: 1000px;
      margin: auto;
      padding: 20px;
    }
    .tabContent.active {
      display: block;
    }
    #toolbar {
      position: sticky;
      top: 60px;
      background: #E41B17;
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 0 20px;
      z-index: 9999;
      color: #FFFFF0;
    }
    #toolbar label, #toolbar button img {
      color: #FFFFF0;
    }
    img.logo {
      width: 100px;
      margin: 20px auto;
      display: block;
      animation: move-logo 5s alternate infinite;
    }
    @keyframes move-logo {
      0% { transform: translateX(100px); }
      100% { transform: translateX(-100px); }
    }
    .item {
      background: #fff;
      margin: 10px auto;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 5px #ccc;
      display: flex;
      border: 2px solid #E41B17;
      align-items: center;
      gap: 15px;
      max-width: 900px;
      color: #8B0000;
    }
    .item img {
      width: 120px;
      height: 120px;
      object-fit: contain;
      border-radius: 6px;
      border: 3px solid #8B0000;
    }
    footer {
      text-align: center;
      margin-top: 40px;
      padding: 20px;
      font-size: 14px;
      color: #8B0000;
      border-top: 2px solid #E41B17;
    }
  </style>
</head>
<body>
  <div id="tabBar">
    <button class="tabBtn active" data-tab="home">الرئيسية</button>
    <button class="tabBtn" data-tab="sales">مبيعات</button>
    <button class="tabBtn" data-tab="returns">مرتجعات</button>
    <button class="tabBtn" data-tab="contact">راسلنا</button>
    <button class="tabBtn" data-tab="admin">الإدارة</button>
  </div>  <div id="home" class="tabContent active">
    <img src="001.jpg" class="logo" alt="Aden Plastic logo" />
    <h2 style="text-align:center; font-weight:bold; color:#8B0000;">شركة عدن الوطنية للصناعات المنزلية</h2>
  </div>  <div id="sales" class="tabContent">
    <div id="toolbar">
      <label for="imageSizeRange">حجم الصورة:</label>
      <input type="range" id="imageSizeRange" min="60" max="300" value="120" />
    </div>
    <div id="items"></div>
  </div>  <div id="returns" class="tabContent">
    <h3 style="text-align:center;">قسم المرتجعات</h3>
    <p style="max-width:800px; margin:auto; text-align:right;">
      هنا يمكنك إدارة المرتجعات الخاصة بالأصناف. هذه الخاصية تحت التطوير حالياً.
    </p>
  </div>  <div id="contact" class="tabContent">
    <h3 style="text-align:center;">تواصل معنا</h3>
    <p style="max-width:800px; margin:auto; text-align:center;">
      لأي استفسار أو دعم، تواصل معنا عبر:<br/>
      الهاتف: 00967772299420<br/>
      البريد الإلكتروني: info@adenplastic.com<br/>
      العنوان: صنعاء - اليمن
    </p>
  </div>  <div id="admin" class="tabContent">
    <div id="adminLogin">
      <h3 style="text-align:center;">تسجيل دخول الإدارة</h3>
      <input type="password" id="adminPassword" placeholder="كلمة المرور" style="width:300px; display:block; margin:10px auto; padding:10px;" />
      <button onclick="checkAdminPassword()" style="display:block; margin:auto;">دخول</button>
    </div>
    <div id="adminPanel" style="display:none;">
      <h3 style="text-align:center;">إدارة الأصناف</h3>
      <table id="adminTable" border="1" style="margin:auto; width:90%; text-align:center; border-collapse:collapse;">
        <thead>
          <tr>
            <th>الاسم</th>
            <th>اسم الصورة</th>
            <th>حذف</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <button onclick="addNewRow()" style="margin: 20px auto; display:block;">إضافة صف جديد</button>
      <button onclick="saveAdminData()" style="margin: 0 auto; display:block;">حفظ التغييرات</button>
    </div>
  </div>  <footer>
    إعداد وبرمجة<br/>
    المميز سوفت للأنظمة المحاسبية المتكاملة<br/>
    م / مروان محمد عبد الله الذماري<br/>
    00967772299420
  </footer>  <script>
    const tabs = document.querySelectorAll('.tabBtn');
    const contents = document.querySelectorAll('.tabContent');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');

        const target = tab.dataset.tab;
        contents.forEach(c => {
          c.classList.toggle('active', c.id === target);
        });
      });
    });

    let itemsData = [];

    document.addEventListener('DOMContentLoaded', () => {
      fetchCSV();
    });

    function fetchCSV() {
      fetch('https://raw.githubusercontent.com/T772299420/Aden_plaste/main/Data.csv')
        .then(res => res.text())
        .then(csvText => {
          const wb = XLSX.read(csvText, { type: 'string' });
          const sheet = wb.Sheets[wb.SheetNames[0]];
          itemsData = XLSX.utils.sheet_to_json(sheet);
        })
        .catch(err => {
          console.error('خطأ تحميل CSV:', err);
          alert('تعذر تحميل بيانات الأصناف من GitHub.');
        });
    }

    function checkAdminPassword() {
      const pass = document.getElementById('adminPassword').value;
      if (pass === '٢٠١٠٢٠') {
        document.getElementById('adminLogin').style.display = 'none';
        document.getElementById('adminPanel').style.display = 'block';
        loadAdminData();
      } else {
        alert('كلمة المرور غير صحيحة!');
      }
    }

    function loadAdminData() {
      const tableBody = document.querySelector("#adminTable tbody");
      tableBody.innerHTML = "";
      itemsData.forEach((item) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td contenteditable="true">${item.name}</td>
          <td contenteditable="true">${item.image}</td>
          <td><button onclick="deleteRow(this)">🗑️</button></td>
        `;
        tableBody.appendChild(row);
      });
    }

    function addNewRow() {
      const tableBody = document.querySelector("#adminTable tbody");
      const row = document.createElement("tr");
      row.innerHTML = `
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td><button onclick="deleteRow(this)">🗑️</button></td>
      `;
      tableBody.appendChild(row);
    }

    function deleteRow(btn) {
      btn.closest("tr").remove();
    }

    function saveAdminData() {
      const rows = document.querySelectorAll("#adminTable tbody tr");
      const newData = [];
      rows.forEach(row => {
        const name = row.cells[0].innerText.trim();
        const image = row.cells[1].innerText.trim();
        if (name && image) {
          newData.push({ name, image });
        }
      });

      const csv = 'name,image\n' + newData.map(item => `${item.name},${item.image}`).join('\n');
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "Data.csv";
      a.click();
      URL.revokeObjectURL(url);
      alert("تم حفظ البيانات بنجاح!");
    }
  </script></body>
  </html>
